<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joez Better Trademark Styling for the Registered and Trademark Symbols</title>
    <style>
        /* CSS to style registered and trademark symbols */
        .symbol-sup {
            font-size: 0.6em; /* Smaller size to mimic superscript */
            vertical-align: super; /* Positions text higher like <sup> */
            line-height: normal; /* Prevents line spacing issues */
        }
    </style>
</head>
<body>
    <h1>Joez Better Trademark Styling for the Registered and Trademark Symbols</h1>
    <h2>CSS:</h2>
    <p>The `.reg-trademark` and `.trademark` classes use `font-size: 0.6em` and `vertical-align: super` to mimic the superscript appearance of <pre><sup>&reg;</sup></pre> and <pre><sup>&trade;</sup></pre>. </p>
      
    <h2>JavaScript:</h2>
    <p>Uses a `TreeWalker` to select text nodes, explicitly excluding those within <pre><sup></pre> or <pre><script></pre> tags via the `acceptNode` filter. </p>
    <p>Applies a regular expression <pre>(®|&reg;|™|&trade;)</pre> to match standalone symbols. </p>
    <p>Wraps matched symbols in <pre><span class="symbol-sup"></pre> tags. </p>

    <h2>Behavior:</h2>
    <p>Standalone ®, &reg;, ™, and &trade; are styled to appear superscripted. </p>
    <p>This solution ensures that only standalone ®, &reg;, ™, and &trade; symbols are styled, leaving <pre><sup>&reg;</sup></pre> and <pre><sup>&trade;</sup></pre> untouched. </p>

    <h2>Example:</h2>
    <ul>
      <li>This is a test of symbols: ®, &reg;, ™, and &trade; in text</li>
      <li>BrandName® and BrandName&reg; should appear superscripted</li>
      <li>ProductName™ and ProductName&trade; should also appear superscripted</li>
      <li>Ignored cases: BrandName<sup>&reg;</sup> and ProductName<sup>&trade;</sup> remain unchanged</li>
    </ul>
  
    <script>
        // ************************************************************************************************************************************************
        // JavaScript to wrap standalone ®, &reg;, ™, and &trade; in spans with symbol-sup class
        setTimeout(() => {
            const SYMBOL_REGEX = /(®|™|&reg;|&trade;)/g;
        
            // Find EVERY text node that contains a symbol
            const xpath = "//text()[contains(., '®') or contains(., '™') or contains(., '&reg;') or contains(., '&trade;')]";
            const nodes = document.evaluate(xpath, document.body, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);
        
            let wrapped = 0;
        
            for (let i = 0; i < nodes.snapshotLength; i++) {
                const textNode = nodes.snapshotItem(i);
        
                // Skip if already wrapped or in excluded areas
                if (textNode.parentNode?.closest('.symbol-sup, sup, script, style, .card-footer')) {
                    continue;
                }
        
                const parent = textNode.parentNode;
                const original = textNode.textContent;
        
                // Replace symbols with wrapped version
                const fixed = original.replace(SYMBOL_REGEX, '<span class="symbol-sup">$1</span>');
        
                if (original === fixed) continue;
        
                // Insert the new HTML
                const temp = document.createElement('div');
                temp.innerHTML = fixed;
                while (temp.firstChild) {
                    parent.insertBefore(temp.firstChild, textNode);
                }
                parent.removeChild(textNode);
        
                wrapped++;
            }
        
            console.table([
                            { Symbol: '® / &reg;', Count: totalReg },
                            { Symbol: '™ / &trade;', Count: totalTm }
                        ]);
        }, 5000); // 5 seconds after page load — ConveyThis is always done by then
        // ****************************************************************
    </script>
</body>
</html>
